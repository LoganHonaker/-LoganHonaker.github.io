YUI.add("hermes-lang-pika-day",(function(e,a){e.Intl.add("hermes/pika-day","en-US",{DATE_FORMAT:[{type:0,value:"MM-DD-YYYY"}],PREVIOUS_MONTH:[{type:0,value:"Previous Month"}],NEXT_MONTH:[{type:0,value:"Next Month"}],JANUARY:[{type:0,value:"January"}],FEBRUARY:[{type:0,value:"February"}],MARCH:[{type:0,value:"March"}],APRIL:[{type:0,value:"April"}],MAY:[{type:0,value:"May"}],JUNE:[{type:0,value:"June"}],JULY:[{type:0,value:"July"}],AUGUST:[{type:0,value:"August"}],SEPTEMBER:[{type:0,value:"September"}],OCTOBER:[{type:0,value:"October"}],NOVEMBER:[{type:0,value:"November"}],DECEMBER:[{type:0,value:"December"}],SUNDAY:[{type:0,value:"Sunday"}],MONDAY:[{type:0,value:"Monday"}],TUESDAY:[{type:0,value:"Tuesday"}],WEDNESDAY:[{type:0,value:"Wednesday"}],THURSDAY:[{type:0,value:"Thursday"}],FRIDAY:[{type:0,value:"Friday"}],SATURDAY:[{type:0,value:"Saturday"}],SUNDAY_SHORT:[{type:0,value:"S"}],MONDAY_SHORT:[{type:0,value:"M"}],TUESDAY_SHORT:[{type:0,value:"T"}],WEDNESDAY_SHORT:[{type:0,value:"W"}],THURSDAY_SHORT:[{type:0,value:"T"}],FRIDAY_SHORT:[{type:0,value:"F"}],SATURDAY_SHORT:[{type:0,value:"S"}]})}),"@VERSION@",{requires:["intl"]});YUI.add("hermes-template-search-slender-advanced-panel",(function(e,n){var t=e.Template.Handlebars.revive({1:function(e,n,t,l,a){var o,c=null!=n?n:e.nullContext||{},s=e.hooks.helperMissing,i=e.escapeExpression,r=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return'\t<div class="advanced-panel">\n\n\t\t<div class="fluid-centered">\n\t\t\t<div class="quick-filter">\n\n\t\t\t\t'+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-color-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:8,column:4},end:{line:8,column:39}}}))+"\n\n\t\t\t\t"+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-style-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:10,column:4},end:{line:10,column:39}}}))+'\n\n\t\t\t</div>\n\t\t\t<div class="advanced-toggle">\n\t\t\t\t<a class=\'tertiary\' title="'+i((r(t,"intlHTMLMessage")||n&&r(n,"intlHTMLMessage")||s).call(c,{name:"intlHTMLMessage",hash:{intlName:"search.TOGGLE_ADVANCED"},data:a,loc:{start:{line:14,column:31},end:{line:14,column:84}}}))+'" href="#" data-track="search-toggle-advanced" aria-haspopup="true" aria-expanded="false">'+i((r(t,"intlHTMLMessage")||n&&r(n,"intlHTMLMessage")||s).call(c,{name:"intlHTMLMessage",hash:{intlName:"search.ADVANCED"},data:a,loc:{start:{line:14,column:174},end:{line:14,column:220}}}))+'<span class="advanced-icon'+(null!=(o=r(t,"if").call(c,null!=n?r(n,"collapseAdvancedOptions"):n,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a,loc:{start:{line:14,column:246},end:{line:14,column:294}}}))?o:"")+'"></span></a>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="advanced-options fluid-centered'+(null!=(o=r(t,"if").call(c,null!=n?r(n,"collapseAdvancedOptions"):n,{name:"if",hash:{},fn:e.program(2,a,0),inverse:e.noop,data:a,loc:{start:{line:18,column:45},end:{line:18,column:93}}}))?o:"")+'">\n\n\t\t\t'+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-orientation-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:20,column:3},end:{line:20,column:44}}}))+"\n\n\t\t\t"+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-min-size-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:22,column:3},end:{line:22,column:41}}}))+"\n\n\t\t\t"+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-date-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:24,column:3},end:{line:24,column:37}}}))+"\n\n\t\t\t"+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-content-filter-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:26,column:3},end:{line:26,column:40}}}))+"\n\n\t\t\t"+i((r(t,"outlet")||n&&r(n,"outlet")||s).call(c,null!=n?r(n,"search-search-in-picker-view"):n,{name:"outlet",hash:{},data:a,loc:{start:{line:28,column:3},end:{line:28,column:42}}}))+"\n\n\t\t</div>\n\n\t</div>\n"},2:function(e,n,t,l,a){return" collapsed"},compiler:[8,">= 4.3.0"],main:function(e,n,t,l,a){var o,c=e.lookupProperty||function(e,n){if(Object.prototype.hasOwnProperty.call(e,n))return e[n]};return"\n"+(null!=(o=c(t,"unless").call(null!=n?n:e.nullContext||{},null!=n?c(n,"showToolbarOnly"):n,{name:"unless",hash:{},fn:e.program(1,a,0),inverse:e.noop,data:a,loc:{start:{line:2,column:0},end:{line:33,column:11}}}))?o:"")},useData:!0}),l={};e.Array.each([],(function(n){var t=e.Template.get("hermes/"+n);t&&(l[n]=t)})),e.Template.register("hermes/search-slender-advanced-panel",(function(n,a){return(a=a||{}).partials=a.partials?e.merge(l,a.partials):l,t(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-search-content-filter",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,r,n){var l=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<p class="option-header tabbable" tabindex="0">'+e.escapeExpression((l(t,"intlMessage")||a&&l(a,"intlMessage")||e.hooks.helperMissing).call(null!=a?a:e.nullContext||{},{name:"intlMessage",hash:{intlName:"search.CONTENT"},data:n,loc:{start:{line:1,column:47},end:{line:1,column:88}}}))+"</p>\n"},useData:!0}),r={};e.Array.each([],(function(a){var t=e.Template.get("hermes/"+a);t&&(r[a]=t)})),e.Template.register("hermes/search-content-filter",(function(a,n){return(n=n||{}).partials=n.partials?e.merge(r,n.partials):r,t(a,n)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-fluid-selection-dropdown",(function(n,t){var e=n.Template.Handlebars.revive({1:function(n,t,e,l,a){var o,i,r=null!=t?t:n.nullContext||{},c=n.hooks.helperMissing,s="function",u=n.escapeExpression,d=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'\t\t\t<div class="radio individual-option-container option-'+u(typeof(i=null!=(i=d(e,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:a,loc:{start:{line:14,column:56},end:{line:14,column:62}}}):i)+'" data-id="'+u(typeof(i=null!=(i=d(e,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:a,loc:{start:{line:14,column:73},end:{line:14,column:79}}}):i)+'">\n\t\t\t\t<input class="options-check-box" type="checkbox" '+(null!=(o=d(e,"if").call(r,null!=t?d(t,"isSelected"):t,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.noop,data:a,loc:{start:{line:15,column:53},end:{line:15,column:85}}}))?o:"")+' data-id="'+u(typeof(i=null!=(i=d(e,"id")||(null!=t?d(t,"id"):t))?i:c)===s?i.call(r,{name:"id",hash:{},data:a,loc:{start:{line:15,column:95},end:{line:15,column:101}}}):i)+'"/>\n\t\t\t\t<label class="value-container">\n\t\t\t\t\t<div class="square"></div>\n\t\t\t\t\t<span class="option-value">'+u(typeof(i=null!=(i=d(e,"name")||(null!=t?d(t,"name"):t))?i:c)===s?i.call(r,{name:"name",hash:{},data:a,loc:{start:{line:18,column:32},end:{line:18,column:40}}}):i)+"</span>\n\t\t\t\t</label>\n\t\t\t</div>\n"},2:function(n,t,e,l,a){return"checked"},compiler:[8,">= 4.3.0"],main:function(n,t,e,l,a){var o,i,r=null!=t?t:n.nullContext||{},c=n.lookupProperty||function(n,t){if(Object.prototype.hasOwnProperty.call(n,t))return n[t]};return'<div class="fluid-selection-dropdown-container">\n\t<div class="fluid-selection-current-value-container">\n\t\t<div class="current-value-container">\n\t\t\t<p class="current-value">\n\t\t\t\t'+n.escapeExpression("function"==typeof(i=null!=(i=c(e,"currentSelection")||(null!=t?c(t,"currentSelection"):t))?i:n.hooks.helperMissing)?i.call(r,{name:"currentSelection",hash:{},data:a,loc:{start:{line:5,column:4},end:{line:5,column:24}}}):i)+'\n\t\t\t</p>\n\t\t\t<svg class="icon icon-dropdown_arrow fluid-selection-dropdown-arrow">\n\t\t\t\t<use xlink:href="#icon-dropdown_arrow"></use>\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n\t<div class="fluid-selection-options-container">\n'+(null!=(o=c(e,"each").call(r,null!=t?c(t,"dropDownOptions"):t,{name:"each",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:13,column:2},end:{line:21,column:11}}}))?o:"")+"\t</div>\n</div>"},useData:!0}),l={};n.Array.each([],(function(t){var e=n.Template.get("hermes/"+t);e&&(l[t]=e)})),n.Template.register("hermes/fluid-selection-dropdown",(function(t,a){return(a=a||{}).partials=a.partials?n.merge(l,a.partials):l,e(t,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("fluid-selection-dropdown-view",(function(t,e){"use strict";var i=require("hermes-core/flog")(e);t.namespace("Views").FluidSelectionDropdown=t.FlickrView.create(this.name,t.FlickrView,[],{initializer:function(t){t.viewConfig?(this.params=t,this.showSelectionTopBar=!1,this.staticTopBarMessage="",this.dropDownOptions={},this.currentSelectionString="",this.currentSelectionArray=[],this.isLocked=!1,this.scrollListen=!0,this.setConfiguration(this.params.viewConfig)):i.error("No configuration was given!")},buildContainer:function(){return this.setContainerWithTemplate("fluid-selection-dropdown",{dropDownOptions:this.getDropDownOptions(),currentSelection:this.currentSelectionString}),this},activate:function(){let t=this.get("container");return this.dropDownContainer=t.one(".fluid-selection-dropdown-container"),this.optionsContainer=t.one(".fluid-selection-options-container"),this.valueContainer=t.one(".fluid-selection-current-value-container"),this.currentValueContainer=t.one(".current-value-container"),t.setStyle("height",`${this.dropDownContainer.get("clientHeight")}px`),this.setElementInAnchorContainer(),this.setDropdownArrowListener(),this.setDropDownOptionListener(),this.updateLockState(),this},setConfiguration:function(t){"viewAnchor"in t&&"object"==typeof t.viewAnchor?this.viewAnchor=t.viewAnchor:i.error("Dropdown needs a node anchor element"),"staticTopBarMessage"in t&&"string"==typeof t.staticTopBarMessage?this.staticTopBarMessage=t.staticTopBarMessage:"showSelectionTopBar"in t&&"boolean"==typeof t.showSelectionTopBar&&(this.showSelectionTopBar=t.showSelectionTopBar),this.setDropDownOptions(t),this.setInitialTopBarState()},setDropDownOptions:function(t){t.dropDownOptions?Array.isArray(t.dropDownOptions)?t.dropDownOptions.length<2?i.error("Dropdown options array needs at least two options"):this.dropDownOptions=t.dropDownOptions:i.error("Dropdown options param is not an array. Must be an array"):i.error("There are no dropdown options")},setInitialTopBarState:function(){var t,e=this;t=this.getDropDownOptions().filter((function(t){return t.isSelected&&e.currentSelectionArray.push(t),t.isSelected})).map((t=>t.name)).join(", "),1===this.currentSelectionArray.length&&(this.isLocked=!0),this.showSelectionTopBar?this.currentSelectionString=t:this.currentSelectionString=this.staticTopBarMessage},setDropdownArrowListener:function(){this.registerEventHandler(this.currentValueContainer.on("click",this.toggleArrow.bind(this)))},setDropDownOptionListener:function(){this.registerEventHandler(this.optionsContainer.delegate("click",this.updateOptionsState.bind(this),".individual-option-container"))},setElementInAnchorContainer:function(){this.get("container").appendChild(this.dropDownContainer)},updateLockState:function(){var t;this.currentSelectionArray.length&&(t=this.getCurrentSelectionId(),this.optionsContainer.one(`.option-${t}`).toggleClass("locked",this.isLocked))},getCurrentSelectionId:function(){return this.currentSelectionArray[0].id},updateOptionsState:function(t){var e=this.getDropDownOptions()[t.currentTarget.getAttribute("data-id")];if(this.isLocked){if(!1!==e.isSelected)return;this.isLocked=!1,this.updateLockState()}t.currentTarget.get("firstElementChild").get("checked")?t.currentTarget.get("firstElementChild").set("checked",!1):t.currentTarget.get("firstElementChild").set("checked",!0),e.isSelected=!e.isSelected,this.updateTopBarState(e),this.fire("valueChanged",e)},updateTopBarState:function(t){var e,i=this.currentValueContainer.one(".current-value");t.isSelected?(this.currentSelectionArray.push(t),this.currentSelectionArray.sort(((t,e)=>t.id-e.id))):(e=this.currentSelectionArray.findIndex((e=>e.alias===t.alias)),this.currentSelectionArray.splice(e,1)),this.showSelectionTopBar&&(this.currentSelectionString=this.currentSelectionArray.map((t=>t.name)).join(", "),i.set("innerHTML",this.currentSelectionString)),1===this.currentSelectionArray.length&&(this.isLocked=!0,this.updateLockState())},toggleArrow:function(){this.dropdownIsOpen?this.close():this.open()},getDropDownOptions:function(){return this.dropDownOptions},open:function(){this.dropdownIsOpen||(this.setFixedPosition(),this.optionsContainer.setStyle("display","block"),this.dropDownContainer.addClass("open"),this.dropdownIsOpen=!0,this.overlayId=this.appContext.overlayManager.push({dismissOnOverlayClick:!0,disableBodyScroll:!1,dismissOnEsc:!0,popBeforePushOther:!0,hideOverlay:!0}),this.appContext.overlayManager.getOverlay(this.overlayId).node.insert(this.dropDownContainer,"after"),this.registerEventHandler(this.appContext.overlayManager.on("pop",(t=>{this.overlayId===t.overlay.id&&this.collapse()}))),this.fire("opened"))},close:function(){this.dropdownIsOpen&&this.appContext.overlayManager.pop(this.overlayId)},setFixedPosition:function(){let t=this.dropDownContainer.getDOMNode().getBoundingClientRect(),e=this.valueContainer.getDOMNode().getBoundingClientRect(),i=t.top,n=t.left,o=this.appContext.viewportData.getHeight()/2;this.dropDownContainer.setStyles({left:`${n}px`,top:`${i}px`,position:"fixed"});let r={};r=e.top>o?{top:"initial",bottom:`${e.height}px`}:{top:`${e.height}px`,bottom:"initial"},this.optionsContainer.setStyles(r)},collapse:function(){this.dropdownIsOpen&&(this.dropDownContainer.setStyles({position:"static"}),this.setElementInAnchorContainer(),this.optionsContainer.setStyle("display","none"),this.dropDownContainer.removeClass("open"),this.dropdownIsOpen=!1,this.fire("closed"))}},{ATTRS:{}})}),"@VERSION@",{requires:["flickr-view","hermes-template-fluid-selection-dropdown"],optionalRequires:["fluid","hermes-core"]});YUI.add("search-content-filter-view",(function(e){e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.params=t,this.viewerPrefs,this.apiContentTypes,this.apiVideoTypes,this.defaultContentTypes,this.defaultVideoTypes,this.fluidDropDownModal,this.dropDownOptions=[{id:0,name:this.intlMessage({intlName:"search.PHOTOS"}),alias:"photos",isSelected:!1,value:"0"},{id:1,name:this.intlMessage({intlName:"search.SCREENSHOTS"}),alias:"screenshots",isSelected:!1,value:"1"},{id:2,name:this.intlMessage({intlName:"common.ILLUSTRATION_ART"}),alias:"illustrationArt",isSelected:!1,value:"2"},{id:3,name:this.intlMessage({intlName:"search.VIRTUAL_PHOTOGRAPHY"}),alias:"virtualPhotography",isSelected:!1,value:"3"},{id:4,name:this.intlMessage({intlName:"search.VIDEOS"}),alias:"videos",isSelected:!1,value:"0,1,2,3"}],this.searchUrl=t.searchUrl||new e.SearchUrl({},this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.currentContentTypeString="",this.dropDownHasFiredChange=!1,this},loadState:function(){var t=this;return this.appContext.getViewer().signedIn&&this.params.modelParams&&this.params.modelParams.viewerNsid?this.appContext.callAPI("flickr.prefs.getPrefs",{user_id:this.params.modelParams.viewerNsid,extras:["content_type_search","no_video_search"].join(",")}).then(function(i){return t.viewerPrefs={content_types:i.settings_prefs.content_type_search,no_video_search:i.settings_prefs.no_video_search},t.populateStatefulData(),e.Promise.resolve()}.bind(t)):(this.populateStatefulData(),e.Promise.resolve())},populateStatefulData:function(){this.apiContentTypes=this.searchUrl.getAPIParam(e.SearchHelper.API.contentTypes),this.apiVideoTypes=this.searchUrl.getAPIParam(e.SearchHelper.API.videoContentTypes),this.defaultContentTypes="0",this.defaultVideoTypes="0",this.apiContentTypes||this.apiVideoTypes||(this.apiContentTypes=this.defaultContentTypes,this.apiVideoTypes=this.defaultVideoTypes,this.viewerPrefs&&(this.viewerPrefs.content_types&&(this.apiContentTypes=this.viewerPrefs.content_types),this.viewerPrefs.no_video_search&&"photos_videos"!==this.viewerPrefs.no_video_search&&(this.apiVideoTypes=""))),!this.apiContentTypes&&this.apiVideoTypes?this.apiContentTypes="":this.apiContentTypes&&!this.apiVideoTypes&&(this.apiVideoTypes=""),this.currentContentTypeString=this.apiContentTypes,this.setInitialSelectionState(this.currentContentTypeString,this.apiVideoTypes)},buildContainer:function(){return this.setContainerWithTemplate("search-content-filter",{}),this},activate:function(){var t=this;this.get("container");return this.fluidDropDownModal=new e.Views.FluidSelectionDropdown({appContext:this.appContext,viewConfig:{dropDownOptions:t.dropDownOptions,viewAnchor:t.get("container"),showSelectionTopBar:!0}}),this.fluidDropDownModal.initialize().then((()=>(t.get("container").appendChild(this.fluidDropDownModal.get("container")),this.fluidDropDownModal.activate()))).then((()=>(this.setAllEventListeners(),this.fluidDropDownModal)))},setAllEventListeners:function(){var t=this;this.registerEventHandler(this.fluidDropDownModal.on("valueChanged",(function(e){t.handleSelectionChanges(e)}))),this.registerEventHandler(this.fluidDropDownModal.on("closed",(function(){t.updateApiParams()}))),this.registerEventHandler(this.fluidDropDownModal.on("opened",(function(){t.registerEventHandler(e.globalEvents.subscribe("window:resize",(function(){t.fluidDropDownModal.close()}))),t.registerEventHandler(e.globalEvents.subscribe("window:scroll",(function(){t.fluidDropDownModal.close()}))),t.registerEventHandler(t.appContext.flapp.before("activeViewChange",(function(e){t.destroy()})))})))},detachEventHandlers:function(){var e=this;this.viewFiredListeners.forEach((e=>e.detach())),this.registeredEventHandles.forEach((function(t){e.detachRegisteredEvent(t),t=null})),this.viewFiredListeners=[],this.registeredEventHandles=[]},updateApiParams:function(){var t=this.getContentTypeString(),i=this.dropDownOptions.find((e=>"videos"===e.alias)),s=!1;t.length?this.searchUrl.params.content_types!==t&&(this.searchUrl.setAPIParam(e.SearchHelper.API.contentTypes,t),s=!0):e.SearchHelper.API.contentTypes.length&&(this.searchUrl.removeAPIParam(e.SearchHelper.API.contentTypes),s=!0),i.isSelected&&!this.searchUrl.params.video_content_types&&(this.searchUrl.setAPIParam(e.SearchHelper.API.videoContentTypes,i.value),s=!0),!i.isSelected&&this.searchUrl.params.video_content_types&&(this.searchUrl.removeAPIParam(e.SearchHelper.API.videoContentTypes),s=!0),s&&this.dropDownHasFiredChange&&this.fire("subviewViewEvent","search:urlUpdate",this.searchUrl)},setInitialSelectionState:function(e,t){var i=this,s=this.dropDownOptions.find((e=>"videos"===e.alias));t&&t.length&&(s.isSelected=!0),e&&e.length&&e.split(",").forEach((function(e){i.dropDownOptions[e].isSelected=!0}))},handleSelectionChanges:function(e){this.dropDownOptions[e.id].isSelected=e.isSelected,this.dropDownHasFiredChange=!0,this.updateContentTypeString()},getContentTypeString:function(){return this.currentContentTypeString},updateContentTypeString:function(){var e=[];this.dropDownOptions.forEach((function(t){if(t.isSelected&&"videos"!==t.alias)return e.push(t.value)})),this.currentContentTypeString=e.join(",")}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-content-filter","search-helper","search-url","fluid-selection-dropdown-view"],langBundles:["search","common"]});YUI.add("search-slender-advanced-panel-view",(function(e){var t="search-advanced-panel-state";e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var i=t.modelParams&&t.modelParams.apiParams?e.merge(t.modelParams.apiParams):{};if(""===this.get("container").get("innerHTML")&&this.setContainerHTML(""),this.searchUrl=new e.SearchUrl(i,this.appContext,t.searchType),t.searchUrl=this.searchUrl,this.unifiedSubviewParams=t.unifiedSubviewParams,this.set("areAdvancedOptionsVisible",this.getStoredAdvancedOptionsState()||t.openAdvanced),this.set("showToolbarOnly",t.showToolbarOnly||t.isMobile),this.set("showFilterMenus",t.showTools&&!t.isMobile),this.set("showSortMenu",t.showSort&&!t.isMobile),this.set("showLayoutToggles",t.showTools&&!t.isMobile),this.set("showInactiveGroupsToggle",t.showInactiveToggle&&!t.isMobile),this.set("isInactiveGroupsToggleChecked","0"!==this.searchUrl.getAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive)),this.set("layoutStyle",t.viewType||e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified),this.appContext.flipper.isFlipped("enable-advanced-search-filters-modal")){let e=this.appContext.viewportData.getWidth()<=700;this.set("showToolbarOnly",t.showToolbarOnly||e),this.set("showFilterMenus",t.showTools&&!e),this.set("showSortMenu",t.showSort&&!e),this.set("showLayoutToggles",t.showTools&&!e)}return this},subviewConfig:{"search-color-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-style-picker-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0},"search-orientation-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-min-size-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-date-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-search-in-picker-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-content-filter-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0}},loadState:function(){var t=this,i=[];return this.appContext.getViewer().signedIn&&i.push(this.appContext.getModel("person-preferences-models",this.appContext.getViewer().nsid).then((function(e){t.set("viewerPrefsModel",e)}))),e.Promise.all(i)},buildContainer:function(){return this.setContainerWithTemplate("search-slender-advanced-panel",{collapseAdvancedOptions:!this.get("areAdvancedOptionsVisible"),showToolbarOnly:this.get("showToolbarOnly")}),this},activate:function(){var e=this.get("container");return this.get("showToolbarOnly")||this.registerEventHandler(e.one(".advanced-toggle").on("click",this.handleAdvancedToggleClick.bind(this))),this.registerEventHandler(e.delegate("mouseenter",this.handleTooltipElemMouseEnter.bind(this),"[data-tooltip-title]")),this.registerEventHandler(e.delegate("mouseleave",this.handleTooltipElemMouseLeave.bind(this),"[data-tooltip-title]")),e.setAttribute("role","toolbar"),this.setupAccessibilityAttributes(),this},setupAccessibilityAttributes:function(){var e=this.get("container"),t=e.all(".tabbable"),i=e.one(".advanced-toggle .tertiary");this.get("areAdvancedOptionsVisible")?(t.setAttribute("tabindex","0"),t.setAttribute("aria-hidden","false"),i&&i.setAttribute("aria-expanded","true")):(t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true"),i&&i.setAttribute("aria-expanded","false"))},onSubviewEvent:function(e,t){var i=t&&t.length&&t[0];switch(i){case"search:urlUpdate":t[1]&&(this.searchUrl=t[1],this.fire("subviewViewEvent","search:dirty"),this.appContext.flapp.navigate(this.searchUrl.getURL()));break;case"search:blackandwhiteStyleSelected":case"search:colorSelected":this.fire("parentViewEvent",i)}},handleLayoutToggleClick:function(e){var t,i,s=this.get("container");e.preventDefault(),(t=e.target.getData("layout-style"))!==this.get("layoutStyle")&&((i=s.one(".layout.selected"))&&i.removeClass("selected"),e.target.addClass("selected"),this.set("layoutStyle",t),this.get("viewerPrefsModel")&&(this.get("viewerPrefsModel").setValue("unifiedSearchViewPref",this.get("layoutStyle")),this.get("viewerPrefsModel").remoteUpdate()),this.fire("subviewViewEvent","search:layoutChange",this.get("layoutStyle")))},handleAdvancedToggleClick:function(t){var i=this.get("container"),s=i.one(".advanced-options"),r=this;t.preventDefault(),i.one(".advanced-icon").toggleClass("collapsed"),s.toggleClass("collapsed"),s.addClass("collapsing"),this.set("areAdvancedOptionsVisible",!this.get("areAdvancedOptionsVisible")),this.storeAdvancedOptionsState(this.get("areAdvancedOptionsVisible")),this.setupAccessibilityAttributes(),this.fire("subviewViewEvent","search:startAdvancedPanelTransition",this.get("areAdvancedOptionsVisible")),e.flutil.onTransitionEnd(s,(function(){s.removeClass("collapsing"),r.fire("subviewViewEvent","search:finishAdvancedPanelTransition",r.get("areAdvancedOptionsVisible"))}))},handleInactiveGroupsToggleChange:function(t){t.halt(),t.target.get("checked")?this.searchUrl.removeAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive):this.searchUrl.setAPIParam(e.SearchHelper.GROUPS_SEARCH_API.filterInactive,"0"),this.appContext.flapp.navigate(this.searchUrl.getURL())},handleTooltipElemMouseEnter:function(t){var i=t.target.getData("tooltip-title"),s=this;t.halt(),this.tooltipDroparound&&this.tooltipDroparound.close(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!0,this.tooltipHoverTimer=setTimeout((function(){s.isHovering&&(s.tooltipDroparound=new e.Views.FluidDroparound({appContext:s.appContext,showDropArrow:!0,dismissOnOverlayClick:!1,dismissOnActionClick:!1,observePageResize:!0,anchorElement:t.target,positionFixed:!0,closeOnScroll:!0,invisibleOverlay:!0,autoSizeToContent:!0,useAnchorOffsetSize:!0,horizCenterToAnchor:!0,preferBottom:t.target.getData("tooltip-prefer-bottom"),classList:"advanced-panel-tooltip",textMessage:i}),s.tooltipDroparound.show())}),300)},handleTooltipElemMouseLeave:function(e){e.halt(),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()},getStoredAdvancedOptionsState:function(){var i;return YUI.Env.isServer||(e.SearchUrl.isSearchUrl(this.appContext.getPreviousURL())?i=e.AttributeHelpers.coerceBoolean(e.StorageHelper.getItem(t,!0)):e.StorageHelper.remove(t,!0)),i||!1},storeAdvancedOptionsState:function(i){YUI.Env.isServer||e.StorageHelper.setItem(t,i,!0)},beforeDestroy:function(){this.detachRegisteredEvents(),clearTimeout(this.tooltipHoverTimer),this.isHovering=!1,this.tooltipDroparound&&this.tooltipDroparound.close()}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","search-color-picker-view","search-style-picker-view","search-orientation-picker-view","search-min-size-picker-view","search-search-in-picker-view","search-date-picker-view","hermes-template-search-slender-advanced-panel","attribute-helpers","storage-helper","flutil","person-preferences-models","search-content-filter-view"],optionalRequires:["pika-day"],langBundles:["search","pika-day","common","share-modal"]});